# Schema for Workflow frontmatter validation
# Usage: Used by validate-architecture.sh to validate workflow files

type: object
required:
  - name
  - description
  - triggers
  - skills

properties:
  name:
    type: string
    pattern: "^[a-z][a-z0-9-]*$"
    description: "Workflow identifier in kebab-case"

  description:
    type: string
    minLength: 10
    maxLength: 200
    description: "Brief description of the workflow process"

  triggers:
    type: array
    items:
      type: string
    minItems: 1
    description: "Keywords that trigger this workflow"

  skills:
    type: array
    items:
      type: string
      pattern: "^[a-z][a-z0-9-]*$"
    minItems: 1
    description: "Skills used by this workflow"

  roles:
    type: array
    items:
      type: string
      pattern: "^[a-z][a-z0-9-]*$"
    description: "Roles that can execute this workflow"

  calls:
    type: array
    items:
      type: string
      pattern: "^[a-z][a-z0-9-]*$"
    description: "Other workflows called by this workflow"

  version:
    type: string
    pattern: "^[0-9]+\\.[0-9]+\\.[0-9]+$"
    description: "Semantic version (e.g., 1.0.0)"

  last-updated:
    type: string
    pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    description: "Last update date (YYYY-MM-DD)"

# Validation rules
rules:
  max-call-depth: 3
  no-circular-dependencies: true

examples:
  simple:
    name: code-review
    description: Processus de revue de code
    triggers: [review, PR, pull request, relecture]
    skills: [git]
    roles: [tech-lead, frontend-developer]

  with-calls:
    name: create-feature
    description: Processus de création d'une nouvelle feature
    triggers: [nouvelle feature, new feature, développer]
    skills: [git, react, testing]
    roles: [frontend-developer, fullstack-developer]
    calls: [code-review]

  deployment:
    name: release
    description: Processus de déploiement en production
    triggers: [déployer, release, mise en production, MEP]
    skills: [git, ci-cd, docker]
    roles: [devops-engineer, tech-lead]
    calls: [rollback]
